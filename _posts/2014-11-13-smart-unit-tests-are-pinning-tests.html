---
layout: post
title: "“Smart Unit Tests” Are “Pinning Tests”"
date: '2014-11-13T21:55:00.001+11:00'
author: Richard Banks
tags:
- testing
- Visual Studio
modified_time: '2014-11-13T21:55:48.954+11:00'
blogger_id: tag:blogger.com,1999:blog-13321238.post-2300460479288910015
blogger_orig_url: http://www.richard-banks.org/2014/11/smart-unit-tests-are-pinning-tests.html
---

<p>You’ve probably seen all the various announcements from Microsoft today, with the most notable being the release of Visual Studio 2015 Preview and the jaw dropping move to open source the .NET Core Framework. Fantastic stuff! Though I won’t go into it in detail here.</p> <p>What I do want to cover are the “Smart Unit Tests” released with the VS2015 Preview, based on the Microsoft Pex research project. The messaging around it has created more than a little confusion. In fact, here’s what one of my colleagues on Twitter sent my way:</p> <blockquote lang="en" class="twitter-tweet"> <p>“Smart Unit Tests” is what happens when you don’t go outside. //cc: <a href="https://twitter.com/rbanks54">@rbanks54</a></p>— Pawel Pabich (@PawelPabich) <a href="https://twitter.com/PawelPabich/status/532828696072056833">November 13, 2014</a></blockquote><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script> <p>During the MVP Summit I spent some time with the people who built this feature to better understand what the intent behind these so called “smart” unit tests. Is it simply so we can tell our managers that we can hit that magic 100% unit test coverage mark now, meet our KPI’s, claim our annual bonus for hitting an arbitrary metric, and still be able to produce rubbish quality applications or is there some other value to it?</p> <p>It turns out that the purpose of the Smart Unit Test feature is to help people in their refactoring efforts. It’s good practice before you go and refactor code to ensure you have a healthy level of test coverage in place so that you can be confident that any changes you make to code don’t break the behaviour of the application. On existing, legacy code without tests, this is often a very expensive and difficult process, and as a result many refactoring efforts occur either without any test coverage at all or simply never happen because they’re too scary.</p> <p>This is where “Smart Unit Tests” come into play. They help you do the <em>“smart”</em> thing and create unit tests that help you pin down the current behaviour of the code, before you do any refactoring.&nbsp; These type of tests are known, unsurprisingly, as <a href="http://c2.com/cgi/wiki?PinningTests">pinning tests</a>.</p> <p>Here’s a good description of a pinning test (<a href="http://www.letscodejavascript.com/v3/blog/2014/02/the_legacy_code_challenge">source</a>), emphasis added:</p> <blockquote> <p><strong>A “pinning test” is not a good test</strong>. It doesn’t try to be. It’s just the simplest, fastest-running test you can write that will allow you to refactor your code. It’s often an end-to-end test, but it could also look at your log files, monkey-patch a core library function, or do something similarly ridiculous. <p>The key here is that the pinning test lets you do your dozens-of-tiny-refactorings loop <em>really quickly</em>. <strong>As the code improves, you add high-quality unit tests.</strong> <strong>Once the tests are good enough, you get rid of the pinning test</strong>. Lather, rinse, repeat.</p></blockquote> <p>Hopefully that helps clear up some confusion. Oh, as a final note, Brian Harry mentioned that <a href="http://blogs.msdn.com/b/bharry/archive/2014/11/12/news-from-connect.aspx">the Smart Unit Tests name is likely to change</a>. Let’s hope so! :-)</p>  