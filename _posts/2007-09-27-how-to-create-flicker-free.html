---
layout: post
title: How To Create a Flicker Free TableLayoutPanel
date: '2007-09-27T18:41:00.001+10:00'
author: Richard Banks
tags:
- readify
- ".net"
- usability
- development
modified_time: '2007-09-27T18:41:35.435+10:00'
blogger_id: tag:blogger.com,1999:blog-13321238.post-1779433840691669224
blogger_orig_url: http://www.richard-banks.org/2007/09/how-to-create-flicker-free.html
---

<p>The <a href="http://msdn2.microsoft.com/en-us/library/system.windows.forms.tablelayoutpanel.aspx">TableLayoutPanel</a> that comes with .NET 2.0 is handy for doing simple HTML style layouts without the hassle of having to embed a browser control in your form and write the HTML.&nbsp; The control is designed to be a lightweight container (not as powerful as the <a href="http://msdn2.microsoft.com/en-us/library/system.windows.forms.datagridview.aspx">DataGridView</a>, but more flexible in it's approach) and you can embed any control you like in it.</p> <p>The main problem however is that the control flickers incredibly badly when it gets resized.&nbsp; </p> <p>For windows forms applications the way to remove flickering is to enable double buffering.&nbsp; For a form you can just set the DoubleBuffered property to true, and while this will reduce flicker when you resize the form itself, the TableLayoutPanels on the form still flicker as they resize.</p> <p>So to fix this you just need to turn on double buffering for the control.&nbsp; Unfortunately, the control doesn't feature a "DoubleBuffered" property.</p> <p>You could try setting the <a href="http://msdn2.microsoft.com/en-us/library/system.windows.forms.controlstyles.aspx">ControlStyles</a> for the control as well, however the <a href="http://msdn2.microsoft.com/en-us/library/system.windows.forms.control.setstyle.aspx">SetStyle</a> method is not exposed by the control.</p> <p>So that means we'll need to use subclassing to set the double buffering flags.&nbsp; The following C# code shows you a simple double buffered TableLayoutPanel :</p><pre class="codeblock"><span style="color: rgb(0,0,255)">using</span> System.ComponentModel;<br /><span style="color: rgb(0,0,255)">using</span> System.Windows.Forms;<br /><br /><span style="color: rgb(0,0,255)">namespace</span> MyNameSpace<br />{<br />    <span style="color: rgb(128,128,128)">///</span><span style="color: rgb(0,128,0)"> </span><span style="color: rgb(128,128,128)">&lt;summary&gt;<br /></span>    <span style="color: rgb(128,128,128)">///</span><span style="color: rgb(0,128,0)"> Double Buffered layout panel - removes flicker during resize operations.<br /></span>    <span style="color: rgb(128,128,128)">///</span><span style="color: rgb(0,128,0)"> </span><span style="color: rgb(128,128,128)">&lt;/summary&gt;<br /></span>    <span style="color: rgb(0,0,255)">public</span> <span style="color: rgb(0,0,255)">partial</span> <span style="color: rgb(0,0,255)">class</span> <span style="color: rgb(43,145,175)">DBLayoutPanel</span> : <span style="color: rgb(43,145,175)">TableLayoutPanel<br /></span>    {<br />        <span style="color: rgb(0,0,255)">public</span> DBLayoutPanel()<br />        {<br />            InitializeComponent();<br />            SetStyle(<span style="color: rgb(43,145,175)">ControlStyles</span>.AllPaintingInWmPaint |<br />              <span style="color: rgb(43,145,175)">ControlStyles</span>.OptimizedDoubleBuffer |<br />              <span style="color: rgb(43,145,175)">ControlStyles</span>.UserPaint, <span style="color: rgb(0,0,255)">true</span>);<br />        }<br /><br />        <span style="color: rgb(0,0,255)">public</span> DBLayoutPanel(<span style="color: rgb(43,145,175)">IContainer</span> container)<br />        {<br />            container.Add(<span style="color: rgb(0,0,255)">this</span>);<br />            InitializeComponent();<br />            SetStyle(<span style="color: rgb(43,145,175)">ControlStyles</span>.AllPaintingInWmPaint |<br />              <span style="color: rgb(43,145,175)">ControlStyles</span>.OptimizedDoubleBuffer |<br />              <span style="color: rgb(43,145,175)">ControlStyles</span>.UserPaint, <span style="color: rgb(0,0,255)">true</span>);<br />        }<br />    }<br />}</pre><br /><p>Create the class as shown, rebuild your code and the toolbox should now show you that a DBLayoutPanel control is available for your UI pleasure.</p><br /><p>Oh, if you happen to have already built forms using the standard TableLayoutPanel you won't need to delete them and start again.&nbsp; Just go into the *.Designer.cs code-beside files and change the TableLayoutPanel references to DBLayoutPanel ones (watch your namespaces!).&nbsp; Rebuild your application and everything should run as it did before, this time without the flickering.</p> 