---
layout: post
title: 'Mocking Comparison – Part 2: Properties'
date: '2010-07-20T17:51:00.001+10:00'
author: Richard Banks
tags:
- mocking
modified_time: '2010-08-06T08:54:03.830+10:00'
blogger_id: tag:blogger.com,1999:blog-13321238.post-7260881324713302006
blogger_orig_url: http://www.richard-banks.org/2010/07/mocking-comparison-part-2-properties.html
---

<p>Carrying on with our Rhino Mocks, Moq and NSubstitute comparison, let’s now look at how the various frameworks handle properties on their mock objects.</p>  <h3>Rhino Mocks</h3>  <p>So in RhinoMocks you have two choices for creating mock objects – using GenerateMock&lt;T&gt;() or GenerateStub&lt;T&gt;().&#160; GenerateMock will create a mock object that tracks calls made to it so that you can assert expectations against which calls were made at the end of your test.&#160; GenerateStub on the other hand creates a stub object, which is to all intents and purposes the same as a mock object just without any of the overhead for tracking which calls were made against it.&#160; In other words you can do asserts to check if a call was made on a mock, but not on a stub.</p>  <p>Why does this matter?&#160; Because properties on mocks and stubs have different default behaviours in RhinoMocks.</p>  <p>For a mock object we have to explicitly indicate if we want a property to have a standard getter/setter applied to it (i.e. just like an autoproperty implementation).&#160; Here’s some code</p>  <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:f32c3428-b7e9-4f15-a8ea-c502c7ff2e88:4a7b31b3-3d89-4d7b-9602-98283b84fa86" class="wlWriterEditableSmartContent"><pre class="brush: c#;">[Fact]<br />public void Rhino_properties()<br />{<br /> var monkey = MockRepository.GenerateMock&lt;IMonkey&gt;();<br /> monkey.Stub(m =&gt; m.Name).PropertyBehavior();<br /><br /> monkey.Name = "Spike";<br /> Assert.Equal("Spike", monkey.Name);<br />}</pre></div><p>and the same test with a stub</p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:f32c3428-b7e9-4f15-a8ea-c502c7ff2e88:2665476f-7488-40f0-872e-8146250c54ba" class="wlWriterEditableSmartContent"><pre class="brush: csharp;">[Fact]<br />public void Rhino_properties()<br />{<br /> var monkey = MockRepository.GenerateStub&lt;IMonkey&gt;();<br /><br /> monkey.Name = "Spike";<br /> Assert.Equal("Spike", monkey.Name);<br />}</pre></div><p>Note that the stubbed object requires none of the property behaviour setup and so it feels more natural.&#160; While some people may prefer to see properties being set up explicitly rather than implicitly I think that if it is a well known behaviour then it’s not going to be a problem that the property behaviour is implicitly provided on the stubbed objects.</p><h3>Moq</h3><p>The Moq code is much the same, however as you can see we have to pay the Moq .Object. tax on our calls.</p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:f32c3428-b7e9-4f15-a8ea-c502c7ff2e88:f3ca25c1-73e0-4d90-b5d8-bcdf652643f4" class="wlWriterEditableSmartContent"><pre class="brush: csharp;">[Fact]<br />public void Moq_properties()<br />{<br /> var monkey = new Mock&lt;IMonkey&gt;();<br /> monkey.SetupProperty(m =&gt; m.Name);<br /><br /> monkey.Object.Name = "Spike";<br /> Assert.Equal("Spike", monkey.Object.Name);<br />}</pre></div><p>This makes the code feel just a little more verbose and cumbersome than the Rhino and NSubstitute versions.</p><p>In fairness, if you want all properties to be automatically set to the standard autoproperty behaviour for a mock object you can use the SetupAllProperties method in Moq as follows:</p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:f32c3428-b7e9-4f15-a8ea-c502c7ff2e88:4d837ffe-3ae2-48eb-b746-c3fbb2e9dea5" class="wlWriterEditableSmartContent"><pre class="brush: c#;">[Fact]<br />public void Moq_properties()<br />{<br /> var monkey = new Mock&lt;IMonkey&gt;();<br /> monkey.SetupAllProperties();<br /><br /> monkey.Object.Name = "Spike";<br /> Assert.Equal("Spike", monkey.Object.Name);<br />}</pre></div><h3>NSubstitute</h3><p>The NSubstitute code shown below is much the same as the Rhino Mocks code when using stubs.&#160; The difference being that NSubstitute doesn’t differentiate between stubs and mocks.</p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:f32c3428-b7e9-4f15-a8ea-c502c7ff2e88:c053b360-f06a-4e3d-a312-be2122995061" class="wlWriterEditableSmartContent"><pre class="brush: c#;">[Fact]<br />public void NSubstitute_properties()<br />{<br /> var monkey = Substitute.For&lt;IMonkey&gt;();<br />   <br /> monkey.Name = "Spike";<br /> Assert.Equal("Spike", monkey.Name);<br />}</pre></div><p>Overall, Rhino and NSubstitute are on par, however the more expressive mock object creation and reduced confusion over whether to use mocks or stubs in NSubstitute tilts the balance in favour of NSubstitute.</p><p>&nbsp;</p><p>Other posts in this series:<ul><li><a href="http://www.richard-banks.org/2010/07/mocking-comparison-part-1-basics.html">1: The Basics</a></li><li><a href="http://www.richard-banks.org/2010/07/mocking-comparison-part-3-interactions.html">3: Interactions</a></li><li><a href="http://www.richard-banks.org/2010/07/mocking-comparison-part-4-parameter.html">4: Parameter Constraints</a></li><li><a href="http://www.richard-banks.org/2010/07/mocking-comparison-part-5-repetitions.html">5: Repetitions</a></li><li><a href="http://www.richard-banks.org/2010/07/mocking-comparison-part-6-multiple.html">6: Multiple Calls</a></li><li><a href="http://www.richard-banks.org/2010/07/mocking-comparison-part-7-exceptions.html">7: Exceptions</a></li><li><a href="http://www.richard-banks.org/2010/07/mocking-comparison-part-8-recursive.html">8: Recursive Mocks</a></li><li><a href="http://www.richard-banks.org/2010/07/mocking-comparison-part-9-functions.html">9: Functions</a></li><li><a href="http://www.richard-banks.org/2010/08/mocking-comparison-part-10-events.html">10: Events</a></li><li><a href="http://www.richard-banks.org/2010/08/mocking-comparison-part-11-multiple.html">11: Multiple Interfaces</a></li><li><a href="http://www.richard-banks.org/2010/08/mocking-comparison-part-12-unmockables.html">12: The UnMockables</a></li></ul></p>