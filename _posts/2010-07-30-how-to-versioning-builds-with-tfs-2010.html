---
layout: post
title: 'How To: Versioning Builds With TFS 2010'
date: '2010-07-30T09:29:00.001+10:00'
author: Richard Banks
tags:
- TFS
modified_time: '2010-09-21T08:41:57.372+10:00'
thumbnail: http://lh4.ggpht.com/_5dD_rBQSs2o/TFIMVd7A1CI/AAAAAAAAAyg/nvi-m7NSKHU/s72-c/image_thumb%5B45%5D.png?imgmax=800
blogger_id: tag:blogger.com,1999:blog-13321238.post-1411332327146950622
blogger_orig_url: http://www.richard-banks.org/2010/07/how-to-versioning-builds-with-tfs-2010.html
---

<p>I’ve written in the past on how to do <a title="Versioning Builds with TFS 2008" href="http://www.richard-banks.org/2007/07/versioning-builds-with-tfs-and-msbuild.html" target="_blank">automatic assembly versioning with TFS Team Build 2008</a> so it’s about time I got around to showing you how to do with with TFS Team Build 2010.</p>  <p>By the way, for a great series of blog posts on customising team build with TFS 2010 it’s worth having a look at <a href="http://www.ewaldhofman.nl/post/2010/04/20/Customize-Team-Build-2010-e28093-Part-1-Introduction.aspx" target="_blank">Ewald Hofman’s series on customising team build</a>.</p>  <h3>What We Want to Achieve</h3>  <p>So, the goal here is to change the standard build process to enable us to do automatic versioning of assemblies.&#160; To do this what we need to do is insert some steps in the process just after the source has been retrieved from TFS.&#160; We want a flow that goes something like this:</p>  <p>Get Latest –&gt; Update AssemblyInfo files with new version –&gt; Do rest of the build</p>  <p>One extra wrinkle to this is that when team build gets the code from TFS the files are in read only mode, so what we’re going to do is switch the read only flag off, change the files, and then turn it back on.&#160; This is just in case an future incremental get tries to update the file – the read only flag will stop TFS checking if the file is different.</p>  <p>One thing we’re not going to do is check the updated assembly info files back into source control.&#160; This means all developer builds will by default have a version number of 1.0.0.0 and build server builds will have an incrementing build number.&#160; It’s a handy way to know if someone has tried to deploy code built on their machine instead of code built by the server.</p>  <p>This approach does raise a small issue though – where do we keep the build number between builds?&#160; i.e. how to we know what the previous build number was so we can increment it.&#160; For this we’re going to use a simple version.txt file stored in the root of the drop folder.&#160; If you want to secure this so that only the build process updates the version number I would suggest making the drop location read only for all users except the account the build runs under.</p>  <p>Anyway, enough talk.&#160; Let’s see what we need to do.</p>  <h3>Getting Started</h3>  <p>1. Open VS2010 and create a solution with two C# Class LIbrary projects in it.&#160; One for the custom build tasks we’re going to create, and one to hold the process template we’re going change.&#160; I have called mine CustomBuildActivities and CustomBuildProcess</p>  <p>2. In the CustomBuildProcess project add a Workflow activity and then delete it.&#160; This just helps with getting a bunch of references in place and adds the appropriate content type we’ll need when we add our build workflow in the next step.</p>  <p><a href="http://lh6.ggpht.com/_5dD_rBQSs2o/TFIMUC1vmQI/AAAAAAAAAyc/MEc5pfYfq8w/s1600-h/image%5B84%5D.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://lh4.ggpht.com/_5dD_rBQSs2o/TFIMVd7A1CI/AAAAAAAAAyg/nvi-m7NSKHU/image_thumb%5B45%5D.png?imgmax=800" width="484" height="274" /></a> </p>  <p>3. Now go copy the DefaultTemplate.xaml file, rename it to something you like and include it in your project.&#160; I’ve called mine VersionedBuildProcess.xaml.&#160; Once it’s included in the solution change the Build Action to XamlAppDef.</p>  <p><a href="http://lh4.ggpht.com/_5dD_rBQSs2o/TFIMWHRZnkI/AAAAAAAAAyk/DsS1UJ2mrL8/s1600-h/image20.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://lh5.ggpht.com/_5dD_rBQSs2o/TFIMXnHAyII/AAAAAAAAAyo/Jv-_vZ3WG8k/image_thumb12.png?imgmax=800" width="319" height="397" /></a> </p>  <p>At this point if you try compiling you’ll get a bunch of missing references, so add the following (sorry it’s a laundry list of items!)</p>  <ul>   <li>System.Drawing </li>    <li>Microsoft.TeamFoundation.Build.Client </li>    <li>Microsoft.TeamFoundation.VersionControl.Client </li>    <li>Microsoft.TeamFoundation.WorkItemTracking.Client </li>    <li>%Program Files%\Microsoft Visual Studio 10.0\Common7\IDE\PrivateAssemblies\      <br />Microsoft.TeamFoundation.Build.Workflow.dll </li>    <li>%Program Files%\Microsoft Visual Studio 10.0\Common7\IDE\PrivateAssemblies\      <br />Microsoft.TeamFoundation.TestImpact.BuildIntegration.dll </li>    <li>%WinDir%\assembly\GAC_MSIL\Microsoft.TeamFoundation.TestImpact.Client      <br />\10.0.0.0__b03f5f7f11d50a3a\Microsoft.TeamFoundation.TestImpact.Client.dll </li> </ul><p><strong>UPDATE:</strong> If you set the Build Action to None then you don't need to worry about setting all those references and you can still edit the XAML as  per usual.  This is a lot easier for many people, but the downside is that you can't verify the workflow is 100% correct unless you manually look through the whole workflow or try a build with it.  My preference is the first, but do whatever you're comfortable with :-) </p>  <h3>Create the First Custom Activity</h3>  <p>Next&#160; we’re going to create our first custom activity – this one will be the one we use to toggles the read only flags on AssemblyInfo files.&#160; In your CustomBuildActivities project add a new Workflow Code Activity called SetReadOnlyFlag.&#160; We’ll use this to toggle the read only bits for our AssemblyInfo files later on.</p>  <p><a href="http://lh3.ggpht.com/_5dD_rBQSs2o/TFIMafOjV-I/AAAAAAAAAys/_zNBttSxGBg/s1600-h/image13.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://lh6.ggpht.com/_5dD_rBQSs2o/TFIMbT9OiGI/AAAAAAAAAyw/Rxsl7JXRIys/image_thumb5.png?imgmax=800" width="484" height="274" /></a> </p>  <p>Now add references to Microsoft.TeamFoundation.Build.Client and Microsoft.TeamFoundation.VersionControl.Client and then use the following code for the class:</p>  <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:f32c3428-b7e9-4f15-a8ea-c502c7ff2e88:faae01f4-4cac-4de0-9aea-9f2cfc3a6ec1" class="wlWriterEditableSmartContent"><pre class="brush: c#;">using System.Activities;<br />using Microsoft.TeamFoundation.Build.Client;<br />using Microsoft.TeamFoundation.VersionControl.Client;<br /><br />namespace CustomActivities<br />{<br /> [BuildActivity(HostEnvironmentOption.Agent)]<br /> public sealed class SetReadOnlyFlag : CodeActivity<br /> {<br />  [RequiredArgument]<br />  public InArgument&lt;string&gt; FileMask { get; set; }<br /><br />  [RequiredArgument]<br />  public InArgument&lt;bool&gt; ReadOnlyFlagValue { get; set; }<br /><br />  [RequiredArgument]<br />  public InArgument&lt;Workspace&gt; Workspace { get; set; }<br /><br />  protected override void Execute(CodeActivityContext context)<br />  {<br />   var fileMask = context.GetValue(FileMask);<br />   var workspace = context.GetValue(Workspace);<br />   var readOnlyFlagValue = context.GetValue(ReadOnlyFlagValue);<br /><br />   foreach (var folder in workspace.Folders)<br />   {<br />    foreach (var file in Directory.GetFiles(folder.LocalItem, fileMask, SearchOption.AllDirectories))<br />    { <br />     var attributes = File.GetAttributes(file);<br />     if (readOnlyFlagValue)<br />      File.SetAttributes(file, attributes | FileAttributes.ReadOnly);<br />     else<br />      File.SetAttributes(file,attributes &amp; ~FileAttributes.ReadOnly);<br />    }<br />   }<br />  }<br /> }<br />}</pre></div><p>The [BuildActivity] attribute on the class indicates that this class can be used as a workflow activity in the designer, and that it should be loaded on the build agent when a build runs.</p><p>This code here is how we define the arguments that the activity will use – they will appear in the properties window when the activity is selected in the designer, and the RequiredAttribute indicates that these properties must have values for the workflow to be valid.</p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:f32c3428-b7e9-4f15-a8ea-c502c7ff2e88:00faf1f5-128d-4c38-90b1-50db5fad5d5f" class="wlWriterEditableSmartContent"><pre class="brush: c#;">[RequiredArgument]<br />public InArgument&lt;string&gt; FileMask { get; set; }<br /><br />[RequiredArgument]<br />public InArgument&lt;bool&gt; ReadOnlyFlagValue { get; set; }<br /><br />[RequiredArgument]<br />public InArgument&lt;Workspace&gt; Workspace { get; set; }<br /></pre></div><p>We’re going to use the Workspace to get information about where the build agent has physically put files on the disk so that we can get path information and search for the files we wish to change.&#160; The other properties are used to actually find out what files to change and which way to set the flag.</p><h3>Create The Second Custom Activity</h3><p>For this activity we want to take a set of files as defined by a mask and do a search/replace on them to update the version numbers for the AssemblyVersion and AssemblyFileVersion attributes.</p><p>Here’s the code:</p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:f32c3428-b7e9-4f15-a8ea-c502c7ff2e88:98483608-f6e3-40d4-903c-cf36001fd7cd" class="wlWriterEditableSmartContent"><pre class="brush: c#;">[BuildActivity(HostEnvironmentOption.Agent)]<br />public sealed class UpdateAssemblyVersionInfo : CodeActivity<br />{<br /> [RequiredArgument]<br /> public InArgument&lt;string&gt; AssemblyInfoFileMask { get; set; }<br /><br /> [RequiredArgument]<br /> public InArgument&lt;string&gt; SourcesDirectory { get; set; }<br /><br /> [RequiredArgument]<br /> public InArgument&lt;string&gt; VersionFilePath { get; set; }<br /><br /> [RequiredArgument]<br /> public InArgument&lt;string&gt; VersionFileName { get; set; }<br /><br /> protected override void Execute(CodeActivityContext context)<br /> {<br />  var sourcesDirectory = context.GetValue(SourcesDirectory);<br />  var assemblyInfoFileMask = context.GetValue(AssemblyInfoFileMask);<br />  var versionFile = context.GetValue(VersionFilePath) + @"\" + context.GetValue(VersionFileName);<br /><br />  //Load the version info into memory<br />  var versionText = "1.0.0.0";<br />  if (File.Exists(versionFile))<br />   versionText = File.ReadAllText(versionFile);<br />  var currentVersion = new Version(versionText);<br />  var newVersion = new Version(currentVersion.Major, currentVersion.Minor, currentVersion.Build + 1, currentVersion.Revision);<br />  File.WriteAllText(versionFile, newVersion.ToString());<br /><br />  bool changedContents;<br />  foreach (var file in Directory.EnumerateFiles(sourcesDirectory, assemblyInfoFileMask, SearchOption.AllDirectories))<br />  {<br />   var text = File.ReadAllText(file);<br />   changedContents = false;<br />   // we want to find 'AssemblyVersion("1.0.0.0")' etc<br />   foreach (var attribute in new[] { "AssemblyVersion", "AssemblyFileVersion" })<br />   {<br />    var regex = new Regex(attribute + @"\(""\d+\.\d+\.\d+\.\d+""\)");<br />    var match = regex.Match(text);<br />    if (!match.Success) continue;<br />    text = regex.Replace(text, attribute + "(\"" + newVersion + "\")");<br />    changedContents = true;<br />   }<br />   if (changedContents)<br />    File.WriteAllText(file, text);<br />  }<br /> }<br />}<br /></pre></div><p>At this point you should be able to compile your application and see it all pass, but until we change the workflow itself this is pretty useless.</p><h3>Updating the Build Workflow</h3><p>In your process project open up the build process.&#160; In the toolbox you should now see something like this:</p><p><a href="http://lh5.ggpht.com/_5dD_rBQSs2o/TFIMcLcy7mI/AAAAAAAAAy0/MFpuFvHboRk/s1600-h/image%5B9%5D.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://lh4.ggpht.com/_5dD_rBQSs2o/TFIMc-QG2LI/AAAAAAAAAy4/y4D4ZkmOy48/image_thumb%5B2%5D.png?imgmax=800" width="237" height="117" /></a> </p><p>We want to drop these tasks into our workflow at the appropriate point, so to do this find the part of the workflow that looks something like this:</p><p><a href="http://lh6.ggpht.com/_5dD_rBQSs2o/TFIMdu8BEUI/AAAAAAAAAy8/-OAtsaGHY-I/s1600-h/image%5B64%5D.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://lh5.ggpht.com/_5dD_rBQSs2o/TFIMed-R1GI/AAAAAAAAAzA/QOvTmzmvGgI/image_thumb%5B25%5D.png?imgmax=800" width="280" height="370" /></a> </p><p>For reference it’s in ….Sequence &gt; Run On Agent &gt; Initialize Workspace (near the bottom)</p><p>Now add a sequence activity after the get workspace activity like so:</p><p><a href="http://lh3.ggpht.com/_5dD_rBQSs2o/TFIMfYUPhWI/AAAAAAAAAzE/NVKC9aNrHQ8/s1600-h/image%5B65%5D.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://lh4.ggpht.com/_5dD_rBQSs2o/TFIMgNO1sxI/AAAAAAAAAzI/0AT8DTSaye4/image_thumb%5B26%5D.png?imgmax=800" width="280" height="206" /></a> </p><p>Change the display name property to “Update AssemblyInfo Versions&quot;” or something similar.&#160; This not only appears in the build log, but has the advantage of helping you understand your workflow better.</p><p>Now drag the ReadOnly flag activity we created into the new sequence activity you added – it should now look something like this:</p><p><a href="http://lh6.ggpht.com/_5dD_rBQSs2o/TFIMg3LM7FI/AAAAAAAAAzM/8fnpNlTNt-k/s1600-h/image%5B66%5D.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://lh5.ggpht.com/_5dD_rBQSs2o/TFIMhyvTe8I/AAAAAAAAAzQ/hF0jy1fom4c/image_thumb%5B27%5D.png?imgmax=800" width="265" height="193" /></a> </p><p>That error indicator means we haven’t yet supplied some property values for the activity, so we’d best do that now.</p><h3>Set Activity Properties</h3><p>If you look at the properties window for our activity you should see something like this:</p><p><a href="http://lh6.ggpht.com/_5dD_rBQSs2o/TFIMi47QgBI/AAAAAAAAAzU/-wjzEJzIxt4/s1600-h/image%5B67%5D.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://lh3.ggpht.com/_5dD_rBQSs2o/TFIMkFgctkI/AAAAAAAAAzY/ql4KI5CRp5U/image_thumb%5B28%5D.png?imgmax=800" width="357" height="226" /></a> </p><p>What we want is for the users of our workflow to be able to specify the values for the FileMask via the Build Definition window, and we want to set the values for the Workspace based on whatever is current in our workflow.</p><p>Let’s tackle the FileMask first.&#160; To do this we’re going to add a new Argument to our overall workflow.&#160; Find the Arguments tab at the bottom of the designer:</p><p><a href="http://lh5.ggpht.com/_5dD_rBQSs2o/TFIMlEjqLcI/AAAAAAAAAzc/qyoVZ-S9GRA/s1600-h/image%5B68%5D.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://lh3.ggpht.com/_5dD_rBQSs2o/TFIMmWATBjI/AAAAAAAAAzg/xn3YZOEU0HM/image_thumb%5B29%5D.png?imgmax=800" width="390" height="148" /></a> </p><p>Click in the Create Argument box and add a new argument called AssemblyInfoMask and give it a default value of “AssemblyInfo.*”</p><p>Before we use this in our activities let’s just make a few more changes to make this argument appear in the build process window the way we want it.&#160; Go to the metadata argument a few lines above and click the ellipsis […] button.&#160; You will see a window appear where we can set values that will let Visual Studio know how to display this argument to the end user.&#160; Let’s do just that:</p><p><a href="http://lh6.ggpht.com/_5dD_rBQSs2o/TFIMnyAM_3I/AAAAAAAAAzk/h1ki1WHf4j8/s1600-h/image%5B69%5D.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://lh5.ggpht.com/_5dD_rBQSs2o/TFIMonRIpqI/AAAAAAAAAzo/A50dUZN1ioo/image_thumb%5B30%5D.png?imgmax=800" width="386" height="455" /></a> </p><p>Now let’s fix the properties on our Activity</p><p><a href="http://lh6.ggpht.com/_5dD_rBQSs2o/TFIMpcLiL7I/AAAAAAAAAzs/hUVaZAckO3Q/s1600-h/image%5B70%5D.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://lh5.ggpht.com/_5dD_rBQSs2o/TFIMqb4tCYI/AAAAAAAAAzw/ApbQfqHqoF0/image_thumb%5B31%5D.png?imgmax=800" width="352" height="226" /></a> </p><p>Now you may be asking where the Workspace value comes from since it’s not an argument for the workflow.&#160; If you look a few activities above you will see a create workspace activity and one of it’s properties is an OutProperty called Result:</p><p><a href="http://lh3.ggpht.com/_5dD_rBQSs2o/TFIMrpo6GYI/AAAAAAAAAz0/wLrGOo0eH-o/s1600-h/image%5B71%5D.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://lh5.ggpht.com/_5dD_rBQSs2o/TFIMsgM0ssI/AAAAAAAAAz4/RFsbzCu5qss/image_thumb%5B32%5D.png?imgmax=800" width="358" height="252" /></a> </p><p>This is where the Workspace variable is created.&#160; Unfortunately there’s not really an easy way of tracking this sort of thing with the workflow, but fortunately most variables in the workflow are well named and you should be able to figure out what most of them do.</p><h3>Finishing the Workflow</h3><p>Let’s finish off the workflow.&#160; Drag the UpdateAssemblyVersionInfo task into the workflow along with a second SetReadOnlyFlag task.</p><p>Before we set the properties on these, we’re going to need one more workflow Argument, being the name of the version file we’re going to store the version information in.</p><p><a href="http://lh5.ggpht.com/_5dD_rBQSs2o/TFIMtUF5l2I/AAAAAAAAAz8/nWLdaDuLMCk/s1600-h/image%5B73%5D.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://lh6.ggpht.com/_5dD_rBQSs2o/TFIMulT5xxI/AAAAAAAAA0A/v2TYw6rTILs/image_thumb%5B34%5D.png?imgmax=800" width="484" height="116" /></a> </p><p>Don’t forget to set the Metadata as well so that it appears in the correct place in Visual Studio when we define builds.</p><p>Now set the properties on the UpdateAssemblyVersionInfo activity as follows:</p><p><a href="http://lh5.ggpht.com/_5dD_rBQSs2o/TFIMvoJkw9I/AAAAAAAAA0E/VUS8n31rh3M/s1600-h/image%5B74%5D.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://lh3.ggpht.com/_5dD_rBQSs2o/TFIMws0qQ9I/AAAAAAAAA0I/4hPQtpf1XsY/image_thumb%5B35%5D.png?imgmax=800" width="339" height="241" /></a> </p><p>Since we want to store the file we hold our version info at the root of the drop location we have set the VersionFilePath to BuildDetail.DropLocationRoot.&#160; You can of course, change this to put it wherever you like.</p><p>Finally set the properties for the second SetReadOnlyFlag task, this time with the ReadOnly flag set to true.</p><p>At this point build your project.&#160; If it’s all OK everything should compile and you should be ready for the next step.</p><h3>Using The New Build Process</h3><p>Before we can use the new build process, we have to ensure both the process and the custom activities are in source control.</p><p>The .xaml process file should be added to the BuildProcessTemplates folder, and I usually place custom activities in a subfolder within that.&#160; For example:</p><p><a href="http://lh4.ggpht.com/_5dD_rBQSs2o/TFIMxWicx8I/AAAAAAAAA0M/icKIvf7oqXE/s1600-h/image%5B75%5D.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://lh5.ggpht.com/_5dD_rBQSs2o/TFIMyEceoCI/AAAAAAAAA0Q/q-C8UBxfjIA/image_thumb%5B36%5D.png?imgmax=800" width="251" height="125" /></a> </p><p>Now we have to tell our Build Controller where to find our custom activities otherwise the build will fail.&#160; Go to Manage Build Controllers…</p><p><a href="http://lh6.ggpht.com/_5dD_rBQSs2o/TFIMzBj7laI/AAAAAAAAA0U/kKm3XCpstzM/s1600-h/image%5B76%5D.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://lh5.ggpht.com/_5dD_rBQSs2o/TFIM1ZNtT_I/AAAAAAAAA0Y/MCKtWT0D4wY/image_thumb%5B37%5D.png?imgmax=800" width="364" height="236" /></a> </p><p>and in the properties window set the path to the activities</p><p><a href="http://lh4.ggpht.com/_5dD_rBQSs2o/TFIM2q9fjkI/AAAAAAAAA0c/XL1FVaVL4Qw/s1600-h/image%5B78%5D.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://lh5.ggpht.com/_5dD_rBQSs2o/TFIM4223eeI/AAAAAAAAA0g/n9eOUU8hAy0/image_thumb%5B39%5D.png?imgmax=800" width="484" height="485" /></a> </p><p>Now we can finally create a build definition.</p><p>In the new build definition window, go to the Process tab, select the Show Details window and Click New..</p><p><a href="http://lh4.ggpht.com/_5dD_rBQSs2o/TFIM6HqNyRI/AAAAAAAAA0k/W72xgKMc3Hg/s1600-h/image%5B80%5D.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://lh6.ggpht.com/_5dD_rBQSs2o/TFIM7NFb5QI/AAAAAAAAA0o/5FBNLAXWxPU/image_thumb%5B41%5D.png?imgmax=800" width="484" height="179" /></a> </p><p>Select an existing .xaml file (being the new process you uploaded)</p><p><a href="http://lh4.ggpht.com/_5dD_rBQSs2o/TFIM8ud3MKI/AAAAAAAAA0s/gA5AAosNr_M/s1600-h/image%5B81%5D.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://lh4.ggpht.com/_5dD_rBQSs2o/TFIM97zSI5I/AAAAAAAAA0w/XBahJtA5CjU/image_thumb%5B42%5D.png?imgmax=800" width="426" height="460" /></a> </p><p>If you set your metadata properties correctly, the process settings should now look something like this:</p><p><a href="http://lh6.ggpht.com/_5dD_rBQSs2o/TFIM_LaXvhI/AAAAAAAAA00/DdqkL4QR0kQ/s1600-h/image%5B82%5D.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://lh4.ggpht.com/_5dD_rBQSs2o/TFINAQcM5gI/AAAAAAAAA04/fPdtTwGytV8/image_thumb%5B43%5D.png?imgmax=800" width="484" height="178" /></a> </p><p>If all goes well, you should get a completed build and see something like the following in the log, indicating our new steps occurred.</p><p><a href="http://lh6.ggpht.com/_5dD_rBQSs2o/TFINBIlfPwI/AAAAAAAAA08/2Had16R-W1g/s1600-h/image%5B83%5D.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://lh6.ggpht.com/_5dD_rBQSs2o/TFINCWtSyQI/AAAAAAAAA1A/I9nbeVDbo5s/image_thumb%5B44%5D.png?imgmax=800" width="365" height="170" /></a> </p><p>Finally go to the drop location, right click one of your assemblies and see that the version information is being updated.</p><h3>Phew! That’s it!&#160; We’re done!</h3><p>I know it’s a fair bit of work getting this all set up, but once you’ve done it once and have your initial workflow project in place, you can use it as the basis for any future process customisations which makes things much quicker.&#160; Also as you get more familiar with the workflows themselves and knowing where to make changes the process customisation itself will also become faster and easier.</p><p>Good luck customising your builds!</p>