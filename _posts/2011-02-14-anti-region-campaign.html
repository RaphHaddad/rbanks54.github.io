---
layout: post
title: The Anti-Region Campaign
date: '2011-02-14T14:39:00.000+11:00'
author: Richard Banks
tags:
- ".net"
- development
modified_time: '2011-02-14T14:39:58.706+11:00'
thumbnail: http://lh6.ggpht.com/_5dD_rBQSs2o/TVii_Yy8dnI/AAAAAAAAA9Y/tkihb1znDCw/s72-c/image_thumb%5B1%5D.png?imgmax=800
blogger_id: tag:blogger.com,1999:blog-13321238.post-9041727981984499372
blogger_orig_url: http://www.richard-banks.org/2011/02/anti-region-campaign.html
---

<p>For the benefit of my twitter followers who know I have an ongoing issue with the abuse of #regions in the code I have to work with, let me take some time to explain why I dislike them so much.&#160; In fact, let this be considered yet another step in my ongoing anti-#region campaign! (similar to <a href="http://www.antiifcampaign.com/" target="_blank">the anti-if campaign</a>)</p>  <p>This is not to say #regions aren’t useful, but that they are far too over used, and until people can consume #regions responsibly, prohibition laws should be enacted.</p>  <h4>Got an Opinion? O‘course You Do!</h4>  <p>Even without reading this post in full I’m sure you already have an opinion and like most people on internet time you’re likely to skim the first paragraph or two and then skip the rest, so to save you time here’s how to leave feedback:</p>  <p><strong><em>If You Agree with Richard:</em></strong> If you too dislike the abuse of #regions then leave a comment on this post. If there’s enough support I might think about starting a proper anti-region campaign.</p>  <p><strong><em>If You Think Richard is a Raving Lunatic: </em></strong>If you think I’m over-reacting, slightly unhinged, don’t understand your special needs and why #regions make the world around you glow, or if you count yourself as a #region lover then I would ask that you leave your comments and feedback on this <a href="http://goo.gl/QMET" target="_blank">post here</a> instead.</p>  <h2>Why Do #Regions Even Exist?</h2>  <p>So why in the name of all things good and holy, do #regions exist in the first place?&#160; Don’t they kill kittens?&#160; Aren’t they pure evil?</p>  <p>Let’s have a look at what the <a href="http://msdn.microsoft.com/en-us/library/9a1ybwek.aspx" target="_blank">MSDN documentation</a> says, shall we?</p>  <blockquote>   <p>#region lets you specify a block of code that you can expand or collapse when using the <a href="http://msdn.microsoft.com/en-us/library/td6a5x4s.aspx">outlining</a> feature of the Visual Studio Code Editor. <strong>In longer code files, it is convenient to be able to collapse or hide one or more regions so that you can focus on the part of the file that you are currently working on.</strong> </p> </blockquote>  <p>OK.&#160; That seems nice on the surface, but isn’t the code I’m working on a class file?&#160; Don’t I need to see it in context? Hmm.&#160; Let’s have a look at the reasons I don’t like #regions shall we:</p>    <h2>Reason 1 – It Hides Code</h2>  <p>So, according the the spec, it’s to hide chunks of code to help us focus more on the bits we’re changing.&#160; Do you see the problem with that?&#160; Why would I, as a developer, want to actually <em>see </em>code?&#160; Are you out of your mind!&#160; Code is the last thing I want to see!&#160; I want to write code, not read it!</p>  <p>I should be able to look at a piece of class and get an understanding of it straight away and how it fits in with the rest of the class.&#160; #regions can prevent that from happening.</p>  <p>How can I actually tell what this code is doing? And apologies for the Hungarian notation VB code – I hope it doesn’t burn your eyes too badly!</p>  <p><a href="http://lh3.ggpht.com/_5dD_rBQSs2o/TVii-sTAP0I/AAAAAAAAA9U/yfxw1ng7cSQ/s1600-h/image%5B3%5D.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://lh6.ggpht.com/_5dD_rBQSs2o/TVii_Yy8dnI/AAAAAAAAA9Y/tkihb1znDCw/image_thumb%5B1%5D.png?imgmax=800" width="493" height="407" /></a></p>  <p>I know there’s something going on in there (the line numbers give me a hint), but can I know at first glance what it is? No chance!&#160; This is a bad thing.</p>  <p>P.S. One valid reason to allow #regions to exist is designer/code generated code.&#160; <strong><em>However </em></strong>the availability of partial classes since Visual Studio 2005 means that a we’ve been able to pull all that designer generated crap out and keep it in a separate file for a long time now.&#160; There’s no need to have that junk cluttering up my own hand crafted junk! #regions are redundant in this case.</p>  <h2>Reason 2 – It Hides What You Think Might Be Code</h2>  <p>I just love seeing this sort of thing:</p>  <p><a href="http://lh5.ggpht.com/_5dD_rBQSs2o/TVijAOKcynI/AAAAAAAAA9c/ikEmdnJM6XI/s1600-h/image%5B7%5D.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://lh3.ggpht.com/_5dD_rBQSs2o/TVijA6brk2I/AAAAAAAAA9g/l7qB7_CpP3U/image_thumb%5B3%5D.png?imgmax=800" width="368" height="72" /></a></p>  <p>There’s gotta be something in that code there right?&#160; Something important!</p>  <p>So let’s open the region and have a look?</p>  <p><a href="http://lh3.ggpht.com/_5dD_rBQSs2o/TVijBckhDrI/AAAAAAAAA9k/6azLbZjP2vw/s1600-h/image%5B11%5D.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://lh6.ggpht.com/_5dD_rBQSs2o/TVijCUt4MRI/AAAAAAAAA9o/6aTSgMBXFRg/image_thumb%5B5%5D.png?imgmax=800" width="484" height="183" /></a></p>  <p>Say what!? There’s nothing useful there at all?! It’s just commented out code?</p>  <p>So the #region is “helping” us by hiding commented out code!&#160; Surely I don’t need a region to help hide that from me, do I?&#160; NO! Just delete the code! Don’t comment it out and wrap it in a #region!&#160; What a great way to waste my time!</p>  <h2>Reason 3 – It Hides Nothing At All</h2>  <p>I don’t know wether to blame horrible coding standard that mandate the presence of specially names regions for segment class files or not but I’m sure you’ve never seen this little gem:</p>  <p><a href="http://lh3.ggpht.com/_5dD_rBQSs2o/TVijCwej8fI/AAAAAAAAA9s/ez8GLNJVlAw/s1600-h/image%5B23%5D.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://lh4.ggpht.com/_5dD_rBQSs2o/TVijDahm8PI/AAAAAAAAA9w/AHRkP3KQ21Q/image_thumb%5B11%5D.png?imgmax=800" width="347" height="30" /></a></p>  <p>Only to open the #region to see what’s inside and realise there’s nothing there!</p>  <p><a href="http://lh3.ggpht.com/_5dD_rBQSs2o/TVijEFP6c2I/AAAAAAAAA90/ovbcnRUbLz8/s1600-h/image%5B27%5D.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://lh5.ggpht.com/_5dD_rBQSs2o/TVijEkmqBhI/AAAAAAAAA94/Gz45Bdqa4ec/image_thumb%5B13%5D.png?imgmax=800" width="403" height="50" /></a></p>  <p>It’s like being given an empty box for your birthday.&#160; All nicely wrapped up and making you wonder what special surprise is hiding inside only to open it and find that your kid brother has been playing a horrible, cruel joke on you.</p>  <p>What’s even better is when you see a class with all the mandatory regions in it (like the code we saw in Reason 1) and yet when you open all the regions up, there’s just a single static method in there and the rest is blank. Or even better, the whole class is empty!</p>  <p>Regions like this fail completely in their mission to help you focus on just the code you need to see, and instead add only noise and confusion to the understanding-what-the-class-does process, and make you doubt any other #regions you see elsewhere in the codebase.</p>  <h2>Reason 4 – It Hides Just One Thing</h2>  <p>What about this #region:</p>  <p><a href="http://lh3.ggpht.com/_5dD_rBQSs2o/TVijFFNa-CI/AAAAAAAAA98/KPm5xpwFVjg/s1600-h/image%5B15%5D.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://lh5.ggpht.com/_5dD_rBQSs2o/TVijFzs1Y4I/AAAAAAAAA-A/PM3HMhlmSgg/image_thumb%5B7%5D.png?imgmax=800" width="361" height="35" /></a></p>  <p>There’s going to be some really complex code in there, right?&#160; Why else would I have a region there, especially since regions are meant to hide code that might distract me!</p>  <p>Open it up and what do I see?</p>  <p><a href="http://lh4.ggpht.com/_5dD_rBQSs2o/TVijGXcOx_I/AAAAAAAAA-E/HuNtI8sX_Wg/s1600-h/image%5B19%5D.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://lh4.ggpht.com/_5dD_rBQSs2o/TVijHIsbsdI/AAAAAAAAA-I/ReTes_xDSlM/image_thumb%5B9%5D.png?imgmax=800" width="574" height="152" /></a></p>  <p>Oh wow! Just as well we used a region to hide a single property!</p>  <p>Again, we’ve added noise to our code base for no reason.</p>  <h2>Reason 5 – It Hides Butt-Ugly Code</h2>  <p>So what about this situation?&#160; You’re looking through a code base and see the method from hell and it’s associated demonic friends.&#160; We don’t want to see that code do we?&#160; No way! We want to hide that complexity, so let’s wrap it up in a region! Great thinking!</p>  <p>This is what we are really doing with our code: <strong>We’re sweeping all that ugly under the carpet</strong>.</p>  <p>As a general principle, classes should have a <a href="http://en.wikipedia.org/wiki/Single_responsibility_principle" target="_blank">single responsibility</a> and methods should be 20 lines of code or less so they stay readable.&#160; If methods are longer than that then you’re likely working at multiple levels of abstraction in the one method or trying to do too much, and you should consider refactoring your code to improve it’s design and readability.</p>  <p>It’s better to keep the ugly visible so that you can deal with it.&#160; Hiding bad code behind regions only serves to make bad code acceptable and it discourages efforts for improving it.</p>  <h2>Reason 6 – It Hides Copy/Paste Efforts</h2>  <p>The <a href="http://en.wikipedia.org/wiki/Don't_repeat_yourself" target="_blank">DRY principle</a> means logic should exist in one place and one place only, not be repeated all over the place, because a change to the logic means finding all the spots that logic exists and fixing them all.&#160; It’s much easier to make a fix once than it is to fix it in multiple places.</p>    <p>If I have a code base covered in regions I can’t tell if one section of code is similar to any other code I’ve seen before, because in all likelihood I’ve not seen it!&#160; It’s probably been hidden away behind #region statements that mask all of the complexity and character of the code, instead making it a big block of beige.</p>  <p>Here’s what code looks like when #regions have been liberally applied to it:</p>  <p><img src="http://gallery.burrowowl.net/index.php?q=/image/15472.jpg" width="360" height="190" /></p>  <p>It all looks the same.&#160; And you’re not sure if it’s laughing at you or about to turn on you!</p>      <h2>What About Grouping Your Code?</h2>  <p>Let’s say you think #regions are great because they allow you to group your code and hide all those messy internal field and property declarations.&#160; If you’ve only got a handful of them, do you really need the #region?&#160; Probably not.&#160; There’s not much to hide.</p>  <p>If you’ve got hundreds of the suckers do you need a #region?&#160; Maybe – though at that point you should be considering the design of your system.&#160; Do you really need a class with that many properties or fields?&#160; Can you alter the design to improve things? Is your class doing too much?&#160; That’s a judgment call you’ll have to make.</p>  <p>My gripe is with #regions is not with the directive in and of itself, but with it’s abuse.&#160; If a #region is being used as I’ve outlined in the reasons above, then it’s time to stop, think about your code and why you’re using a #region and to then do yourself a favour.&#160; Remove the #region and start writing better code instead.</p>  <p>That will be all.</p>