---
layout: post
title: Windows Media Player and “In Use” External USB Hard Drives
date: '2011-05-04T09:51:00.001+10:00'
author: Richard Banks
tags:
- usability
- general
modified_time: '2011-05-04T09:51:01.189+10:00'
thumbnail: http://lh3.ggpht.com/_5dD_rBQSs2o/TcCUAbr9zLI/AAAAAAAABDo/2H96VJGaBh8/s72-c/image_thumb%5B14%5D.png?imgmax=800
blogger_id: tag:blogger.com,1999:blog-13321238.post-7553739518097190805
blogger_orig_url: http://www.richard-banks.org/2011/05/windows-media-player-and-in-use.html
---

<p>I have a lovely new 1TB external hard drive and moved all my music onto it a short while ago.&#160; Now even though I have iPods and iPhones, for playing that music from my laptop, ITunes on Windows is pretty poor so I’ve tended to use Media Player and, more recently, Zune for that task.</p>  <p>Now, as you would expect I wanted my music into these programs automatically I included the music folder in my library as shown:</p>  <p><a href="http://lh6.ggpht.com/_5dD_rBQSs2o/TcCT2jPv_9I/AAAAAAAABDk/Qr8wdcv0euY/s1600-h/image%5B40%5D.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://lh3.ggpht.com/_5dD_rBQSs2o/TcCUAbr9zLI/AAAAAAAABDo/2H96VJGaBh8/image_thumb%5B14%5D.png?imgmax=800" width="484" height="439" /></a></p>  <p>Now given I’m on a laptop and I usually want to leave work at the end of the day I’ll Safely Remove the drive from my laptop before packing up, but now when I do I get either the infamous <em>“Windows can't stop your 'Generic Volume' device because it is in use”</em> message or the “Problem Ejecting USB Mass Storage Device” message as shown:</p>  <p><a href="http://lh5.ggpht.com/_5dD_rBQSs2o/TcCUDGmw4lI/AAAAAAAABDs/2bGLl0Tytq4/s1600-h/image%5B41%5D.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://lh6.ggpht.com/_5dD_rBQSs2o/TcCUFaIcs9I/AAAAAAAABDw/BrSMXMeeZ94/image_thumb%5B15%5D.png?imgmax=800" width="479" height="175" /></a></p>  <p>But I closed Media Player (and everything else) so it can’t be locking files can it? </p>  <p>Now, as it happens, in the past I’ve seen Windows Search Indexing locking external drives, but I’d already made sure that the drive isn’t indexed by turning off the flag in the properties window:</p>  <p><a href="http://lh5.ggpht.com/_5dD_rBQSs2o/TcCUHyNNaTI/AAAAAAAABD0/MseDw8Wae00/s1600-h/image%5B43%5D.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://lh5.ggpht.com/_5dD_rBQSs2o/TcCUKFFMj4I/AAAAAAAABD4/D10qSrSC0M4/image_thumb%5B17%5D.png?imgmax=800" width="381" height="509" /></a></p>  <p>and if I look at the Indexing Options in Control Panel I see this:</p>  <p><a href="http://lh5.ggpht.com/_5dD_rBQSs2o/TcCUNiGO52I/AAAAAAAABD8/mYTzDdiopmU/s1600-h/image%5B45%5D.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://lh5.ggpht.com/_5dD_rBQSs2o/TcCUQkXq-QI/AAAAAAAABEA/FOTLjPDuMKw/image_thumb%5B19%5D.png?imgmax=800" width="418" height="585" /></a></p>  <p>You can see that the G: drive (the external) isn’t indexed, yet if you look at the location summary in the bottom pane there’s a folder called Music there.&#160; What gives?</p>  <p>So I expand the G: drive settings and what do I see? That the folder is, in fact, indexed by Windows Search and it is very likely locking the drive.&#160; What the…?! Why isn’t the G:\ drive showing with a greyed checkbox to indicate that one or more child folders are included.&#160; Thanks for the great UI there, Microsoft.</p>  <p><a href="http://lh4.ggpht.com/_5dD_rBQSs2o/TcCUUMeLckI/AAAAAAAABEE/1HpLqLKIguU/s1600-h/image%5B47%5D.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://lh5.ggpht.com/_5dD_rBQSs2o/TcCUdoDCO5I/AAAAAAAABEI/rLCen816xms/image_thumb%5B21%5D.png?imgmax=800" width="418" height="585" /></a></p>  <p>So if I just clear it now, then I’ll be able to safely remove the drive, but this is what happens in Media Player’s settings:</p>  <p><a href="http://lh5.ggpht.com/_5dD_rBQSs2o/TcCUhE2sQhI/AAAAAAAABEM/zKsCq3yqwss/s1600-h/image%5B48%5D.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://lh6.ggpht.com/_5dD_rBQSs2o/TcCUjiXb0XI/AAAAAAAABEQ/Vnc3rYxMprM/image_thumb%5B22%5D.png?imgmax=800" width="536" height="486" /></a></p>  <p>Which of means that new items I add to my Music folder won’t automatically appear.&#160; That’s not what I want.&#160; In fact it sucks.</p>  <p>Maybe I should just use the Zune player instead? Unfortunately, by default, Zune relies on the Windows Media Player library settings, so to break the dependency I have to go into Zune settings and unlink the Zune folders from the windows libraries.</p>  <p><a href="http://lh6.ggpht.com/_5dD_rBQSs2o/TcCUk3uWbjI/AAAAAAAABEU/X3rdTWZoDTk/s1600-h/image%5B49%5D.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://lh4.ggpht.com/_5dD_rBQSs2o/TcCUmGgz-5I/AAAAAAAABEY/NAjPsSNsEeM/image_thumb%5B23%5D.png?imgmax=800" width="390" height="164" /></a></p>  <p>Now I can add the Music folder from the external USB drive and Zune will automatically index the folder and pick up changes to the contents, just as I wanted.&#160; And it does it without keeping the drive locked when I exit the program.</p>  <p><a href="http://lh5.ggpht.com/_5dD_rBQSs2o/TcCUslWaVqI/AAAAAAAABEc/xrSWJpVac6M/s1600-h/image%5B50%5D.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://lh4.ggpht.com/_5dD_rBQSs2o/TcCUzF4jYaI/AAAAAAAABEg/mmLwQWR3l5E/image_thumb%5B24%5D.png?imgmax=800" width="380" height="99" /></a></p>  <p>So now when I want to go home, I can just close Zune and then safely remove the drive as I would expect.</p>  <p><a href="http://lh3.ggpht.com/_5dD_rBQSs2o/TcCU0jwAZlI/AAAAAAAABEk/Gn5HvIKx-9Y/s1600-h/image%5B51%5D.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://lh3.ggpht.com/_5dD_rBQSs2o/TcCU3_-3iWI/AAAAAAAABEo/oaVUclTbVcg/image_thumb%5B25%5D.png?imgmax=800" width="360" height="133" /></a></p>                                <p>&#160;</p>  <p>Phew! Talk about a major pain in the butt! How is a normal, non technical person ever going to figure this out for themselves.&#160; Maybe I should’ve just stuck with iTunes – at least it doesn’t lock your external drives on you.</p>  